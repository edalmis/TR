import{s as z,f as h,a as G,l as L,g as f,h as q,r as w,c as A,d as E,m as B,R,j as y,i as J,u as o,Q as U,v as N,n as K,w as P,x as W}from"./scheduler.7c1da786.js";import{S as F,i as H}from"./index.7a22757c.js";import{g as S}from"./navigation.8a75274b.js";import{o as X,e as Y,c as Z}from"./ModalValues.a888a47e.js";import{c as $,b as tt,t as et,g as ot}from"./store.7f25bae6.js";function lt(c){let t,l,s="Google Authenticator",p,a,v="Use Google Authenticator App to scan the QR Code",m,i,C,n,u,x="Code d'authentification Google :",Q,_,d,D,g,M="Verify Code",T,I,j,b,k;return{c(){t=h("div"),l=h("div"),l.textContent=s,p=G(),a=h("div"),a.textContent=v,m=G(),i=h("img"),n=G(),u=h("div"),u.textContent=x,Q=G(),_=h("div"),d=h("input"),D=G(),g=h("button"),g.textContent=M,T=G(),I=h("div"),j=L(c[1]),this.h()},l(r){t=f(r,"DIV",{});var e=q(t);l=f(e,"DIV",{"data-svelte-h":!0}),w(l)!=="svelte-tmpiqs"&&(l.textContent=s),p=A(e),a=f(e,"DIV",{"data-svelte-h":!0}),w(a)!=="svelte-1c70cjx"&&(a.textContent=v),m=A(e),i=f(e,"IMG",{src:!0,alt:!0}),n=A(e),u=f(e,"DIV",{"data-svelte-h":!0}),w(u)!=="svelte-15vehko"&&(u.textContent=x),Q=A(e),_=f(e,"DIV",{});var V=q(_);d=f(V,"INPUT",{type:!0,placeholder:!0}),D=A(V),g=f(V,"BUTTON",{class:!0,"data-svelte-h":!0}),w(g)!=="svelte-1phq86a"&&(g.textContent=M),V.forEach(E),T=A(e),I=f(e,"DIV",{});var O=q(I);j=B(O,c[1]),O.forEach(E),e.forEach(E),this.h()},h(){R(i.src,C=c[0])||y(i,"src",C),y(i,"alt","Error Google generating QR"),y(d,"type","text"),y(d,"placeholder","Put code here !"),y(g,"class","svelte-18uqrg")},m(r,e){J(r,t,e),o(t,l),o(t,p),o(t,a),o(t,m),o(t,i),o(t,n),o(t,u),o(t,Q),o(t,_),o(_,d),U(d,c[2]),o(_,D),o(_,g),o(t,T),o(t,I),o(I,j),b||(k=[N(d,"input",c[5]),N(g,"click",c[6])],b=!0)},p(r,[e]){e&1&&!R(i.src,C=r[0])&&y(i,"src",C),e&4&&d.value!==r[2]&&U(d,r[2]),e&2&&K(j,r[1])},i:P,o:P,d(r){r&&E(t),b=!1,W(k)}}}function st(c,t,l){let s,{QrCode:p}=t,{login:a}=t,v="";async function m(){const n=await fetch(`http://localhost:3000/auth/verify_2fa?code=${s}&login=${a}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(n.ok){console.log("-[ Google Authentificator ]- OK !");let u=await n.json();if(u.jwt!==null){const x=u.jwt;console.log("-[Google Auth]-JWT: de la Reponse GoogleAuth",x),localStorage.setItem("jwt",x),$.set(!0),tt.set(!0),et.set(!0)}else console.log("Google Auth ParamÃ¨tre 'jwt' { NULL }."),ot.set(!1),X("errorMsg"),S("/"),Y.set("Google Auth Code Incorect !")}}function i(){s=this.value,l(2,s)}const C=async()=>{s.length?/^\d+$/.test(s)?s.length!=6?l(1,v="Only 6 digits plz"):(m(),Z(),S("/")):l(1,v="Only digits plz"):l(1,v="Cannot be empty")};return c.$$set=n=>{"QrCode"in n&&l(0,p=n.QrCode),"login"in n&&l(4,a=n.login)},l(2,s=""),[p,v,s,m,a,i,C]}class ut extends F{constructor(t){super(),H(this,t,st,lt,z,{QrCode:0,login:4})}}export{ut as G};
